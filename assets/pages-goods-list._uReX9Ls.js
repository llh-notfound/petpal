import{r as l,H as e,o as a,c as s,w as t,k as u,i as c,a as i,b as o,v as r,d,e as f,I as n,y as v,S as _,f as g,F as m,g as p,j as k,t as y,A as b,n as C}from"./index-BC-mzwrj.js";import{_ as h}from"./no-result.jRaFDIvK.js";import{m as w}from"./mockGoods.Bj7nj5o7.js";import{_ as x}from"./_plugin-vue_export-helper.BCo6x5W8.js";const j=x({__name:"list",setup(x){const j=l(""),B=l("default"),F=l("desc"),S=l(!1),V=l(""),A=l(""),G=l(""),I=l([]),z=l(1),H=l(10),L=l(0),O=l(!1),R=l(!0),U=l(!1),$=["皇家","冠能","宝路","萌能","麦富迪"],q=[{label:"0-50元",min:0,max:50},{label:"50-100元",min:50,max:100},{label:"100-200元",min:100,max:200},{label:"200元以上",min:200,max:1/0}],D=["主食","零食","玩具","日用品","洗护用品"],E=e((()=>{let l=[...I.value];return j.value&&(l=l.filter((l=>l.name.includes(j.value)))),V.value&&(l=l.filter((l=>l.brand===V.value))),G.value&&(l=l.filter((l=>l.category===G.value))),A.value&&(l=l.filter((l=>l.price>=A.value.min&&l.price<=A.value.max))),"sales"===B.value?l.sort(((l,e)=>e.sales-l.sales)):"price"===B.value&&("asc"===F.value?l.sort(((l,e)=>l.price-e.price)):l.sort(((l,e)=>e.price-l.price))),l})),J=l=>{"price"===l?"price"===B.value?F.value="asc"===F.value?"desc":"asc":(B.value="price",F.value="desc"):B.value=l,z.value=1,M()},K=()=>{z.value=1,M()},M=async(l=!1)=>{if(!O.value){O.value=!0;try{const e={page:z.value,pageSize:H.value,keyword:j.value};"price"===B.value?(e.sortBy="price",e.sortOrder=F.value):"sales"===B.value&&(e.sortBy="sales");const a=await w.getGoodsList(e);I.value=l?[...I.value,...a.list]:a.list,L.value=a.total}catch(e){console.error("获取商品列表失败:",e),u({title:"获取商品列表失败",icon:"none"})}finally{O.value=!1,U.value=!1}}},N=()=>{O.value||I.value.length>=L.value||(z.value++,M(!0))},P=()=>{U.value=!0,z.value=1,M()},Q=()=>{V.value="",A.value="",G.value=""},T=()=>{S.value=!1,z.value=1,M()},W=()=>{b()};return a((()=>{M()})),(l,e)=>{const a=d,u=c,b=n,w=k,x=_;return i(),s(u,{class:"goods-list-container"},{default:t((()=>[o(u,{class:"nav-bar"},{default:t((()=>[o(u,{class:"back-btn",onClick:W},{default:t((()=>[o(a,{class:"iconfont icon-back"})])),_:1}),o(a,{class:"page-title"},{default:t((()=>[f("宠物用品")])),_:1})])),_:1}),o(u,{class:"search-bar"},{default:t((()=>[o(u,{class:"search-input"},{default:t((()=>[o(a,{class:"iconfont icon-search"}),o(b,{type:"text",modelValue:j.value,"onUpdate:modelValue":e[0]||(e[0]=l=>j.value=l),placeholder:"搜索宠物用品",onConfirm:K},null,8,["modelValue"])])),_:1})])),_:1}),o(u,{class:"filter-bar"},{default:t((()=>[o(u,{class:v(["filter-item",{active:"default"===B.value}]),onClick:e[1]||(e[1]=l=>J("default"))},{default:t((()=>[o(a,null,{default:t((()=>[f("综合排序")])),_:1})])),_:1},8,["class"]),o(u,{class:v(["filter-item",{active:"sales"===B.value}]),onClick:e[2]||(e[2]=l=>J("sales"))},{default:t((()=>[o(a,null,{default:t((()=>[f("销量")])),_:1})])),_:1},8,["class"]),o(u,{class:v(["filter-item",{active:"price"===B.value}]),onClick:e[3]||(e[3]=l=>J("price"))},{default:t((()=>[o(a,null,{default:t((()=>[f("价格")])),_:1}),o(u,{class:"price-arrows"},{default:t((()=>[o(a,{class:v(["arrow-up",{active:"asc"===F.value}])},{default:t((()=>[f("▲")])),_:1},8,["class"]),o(a,{class:v(["arrow-down",{active:"desc"===F.value}])},{default:t((()=>[f("▼")])),_:1},8,["class"])])),_:1})])),_:1},8,["class"]),o(u,{class:"filter-item",onClick:e[4]||(e[4]=l=>S.value=!0)},{default:t((()=>[o(a,null,{default:t((()=>[f("筛选")])),_:1}),o(a,{class:"iconfont icon-filter"})])),_:1})])),_:1}),o(x,{"scroll-y":"",class:"goods-scroll-view",onScrolltolower:N,onRefresherrefresh:P,"refresher-enabled":"","refresher-triggered":U.value},{default:t((()=>[E.value.length>0?(i(),s(u,{key:0,class:"goods-grid"},{default:t((()=>[(i(!0),g(m,null,p(E.value,((l,e)=>(i(),s(u,{class:"goods-item",key:e,onClick:e=>{return a=l.id,void C({url:`/pages/goods/detail?id=${a}`});var a}},{default:t((()=>[o(w,{src:l.image,mode:"aspectFill",class:"goods-image"},null,8,["src"]),o(u,{class:"goods-info"},{default:t((()=>[o(a,{class:"goods-name"},{default:t((()=>[f(y(l.name),1)])),_:2},1024),o(a,{class:"goods-price"},{default:t((()=>[f("¥"+y(l.price),1)])),_:2},1024),o(a,{class:"goods-sales"},{default:t((()=>[f(y(l.sales)+"人已购买",1)])),_:2},1024)])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1})):r("",!0),E.value.length>0?(i(),s(u,{key:1,class:"loading-status"},{default:t((()=>[O.value?(i(),s(a,{key:0},{default:t((()=>[f("正在加载更多...")])),_:1})):R.value?r("",!0):(i(),s(a,{key:1},{default:t((()=>[f("已经到底了")])),_:1}))])),_:1})):r("",!0),0!==E.value.length||O.value?r("",!0):(i(),s(u,{key:2,class:"no-goods"},{default:t((()=>[o(w,{src:h,mode:"aspectFit"}),o(a,null,{default:t((()=>[f("暂无相关商品")])),_:1})])),_:1}))])),_:1},8,["refresher-triggered"]),S.value?(i(),s(u,{key:0,class:"filter-dialog"},{default:t((()=>[o(u,{class:"filter-dialog-mask",onClick:e[5]||(e[5]=l=>S.value=!1)}),o(u,{class:"filter-dialog-content"},{default:t((()=>[o(u,{class:"filter-dialog-header"},{default:t((()=>[o(a,null,{default:t((()=>[f("筛选")])),_:1}),o(a,{class:"close-btn",onClick:e[6]||(e[6]=l=>S.value=!1)},{default:t((()=>[f("×")])),_:1})])),_:1}),o(u,{class:"filter-section"},{default:t((()=>[o(u,{class:"filter-section-title"},{default:t((()=>[f("品牌")])),_:1}),o(u,{class:"filter-tags"},{default:t((()=>[(i(),g(m,null,p($,((l,e)=>o(u,{class:v(["filter-tag",{active:V.value===l}]),key:e,onClick:e=>V.value=V.value===l?"":l},{default:t((()=>[f(y(l),1)])),_:2},1032,["class","onClick"]))),64))])),_:1})])),_:1}),o(u,{class:"filter-section"},{default:t((()=>[o(u,{class:"filter-section-title"},{default:t((()=>[f("价格区间")])),_:1}),o(u,{class:"filter-tags"},{default:t((()=>[(i(),g(m,null,p(q,((l,e)=>o(u,{class:v(["filter-tag",{active:A.value===l}]),key:e,onClick:e=>A.value=A.value===l?"":l},{default:t((()=>[f(y(l.label),1)])),_:2},1032,["class","onClick"]))),64))])),_:1})])),_:1}),o(u,{class:"filter-section"},{default:t((()=>[o(u,{class:"filter-section-title"},{default:t((()=>[f("分类")])),_:1}),o(u,{class:"filter-tags"},{default:t((()=>[(i(),g(m,null,p(D,((l,e)=>o(u,{class:v(["filter-tag",{active:G.value===l}]),key:e,onClick:e=>G.value=G.value===l?"":l},{default:t((()=>[f(y(l),1)])),_:2},1032,["class","onClick"]))),64))])),_:1})])),_:1}),o(u,{class:"filter-dialog-footer"},{default:t((()=>[o(u,{class:"reset-btn",onClick:Q},{default:t((()=>[f("重置")])),_:1}),o(u,{class:"confirm-btn",onClick:T},{default:t((()=>[f("确定")])),_:1})])),_:1})])),_:1})])),_:1})):r("",!0)])),_:1})}}},[["__scopeId","data-v-faaa4bb7"]]);export{j as default};
