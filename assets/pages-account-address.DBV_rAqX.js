import{r as e,o as a,p as l,c as s,w as t,i as o,N as n,a as u,b as i,d as c,e as d,S as r,v as f,j as v,f as p,F as m,g as _,t as g,y as h,I as k,P as y,T as D,U as C,x,A as b,E as A,D as V,K as w,k as j,u as F}from"./index-BC-mzwrj.js";import{_ as I}from"./_plugin-vue_export-helper.BCo6x5W8.js";const L=I({__name:"address",setup(I){const L=e([]),S=e(!1),U=e(!1),E=e(1);e(10);const P=e(null),T=e(!1),K=e(null),N=e({name:"",phone:"",region:"",regionArray:[],detail:"",isDefault:!1}),$=[{id:"A001",name:"张三",phone:"13800138000",region:"广东省深圳市南山区",regionArray:["广东省","深圳市","南山区"],detail:"科技园南区8栋101室",isDefault:!0},{id:"A002",name:"李四",phone:"13900139000",region:"广东省广州市天河区",regionArray:["广东省","广州市","天河区"],detail:"天河路385号太古汇",isDefault:!1}],q=()=>{U.value=!0,setTimeout((()=>{L.value=$,S.value=!1,U.value=!1,E.value++}),500)},z=()=>{!U.value&&S.value&&q()},B=()=>{P.value.close()},G=e=>{const a=e.detail.value;N.value.regionArray=a,N.value.region=a.join("")},H=e=>{N.value.isDefault=e.detail.value},J=()=>{if(N.value.name)if(N.value.phone)if(/^1\d{10}$/.test(N.value.phone))if(N.value.region)if(N.value.detail){if(N.value.isDefault&&L.value.forEach((e=>{e.isDefault=!1})),T.value){const e=L.value.findIndex((e=>e.id===K.value.id));e>-1&&(L.value[e]={...K.value,...N.value})}else{const e={id:"A"+Date.now().toString().slice(-6),...N.value};L.value.push(e)}P.value.close(),j({title:T.value?"修改成功":"添加成功",icon:"success"}),F("addressList",L.value)}else j({title:"请输入详细地址",icon:"none"});else j({title:"请选择所在地区",icon:"none"});else j({title:"手机号码格式不正确",icon:"none"});else j({title:"请输入手机号码",icon:"none"});else j({title:"请输入收货人姓名",icon:"none"})},M=()=>{b()};return a((()=>{const e=l("addressList");e&&e.length>0?L.value=e:q()})),(e,a)=>{const l=c,I=o,U=v,E=r,$=k,q=y,O=D,Q=C,R=x,W=n("uni-popup");return u(),s(I,{class:"address-container"},{default:t((()=>[i(I,{class:"nav-bar"},{default:t((()=>[i(l,{class:"nav-title"},{default:t((()=>[d("地址管理")])),_:1}),i(l,{class:"nav-back iconfont icon-back",onClick:M})])),_:1}),i(E,{"scroll-y":"",class:"address-scroll-view",onScrolltolower:z},{default:t((()=>[0===L.value.length?(u(),s(I,{key:0,class:"empty-tip"},{default:t((()=>[i(U,{class:"empty-icon",src:"/petpal/static/images/empty-address.png"}),i(l,null,{default:t((()=>[d("暂无收货地址")])),_:1})])),_:1})):f("",!0),i(I,{class:"address-list"},{default:t((()=>[(u(!0),p(m,null,_(L.value,((e,a)=>(u(),s(I,{key:a,class:"address-item"},{default:t((()=>[i(I,{class:"address-info",onClick:a=>(e=>{const a=A(),l=a[a.length-2];l&&l.route.includes("order")&&(V("addressSelected",e),b())})(e)},{default:t((()=>[i(I,{class:"address-header"},{default:t((()=>[i(l,{class:"contact-name"},{default:t((()=>[d(g(e.name),1)])),_:2},1024),i(l,{class:"contact-phone"},{default:t((()=>[d(g(e.phone),1)])),_:2},1024),e.isDefault?(u(),s(l,{key:0,class:"default-tag"},{default:t((()=>[d("默认")])),_:1})):f("",!0)])),_:2},1024),i(I,{class:"address-detail"},{default:t((()=>[i(l,{class:"region"},{default:t((()=>[d(g(e.region),1)])),_:2},1024),i(l,{class:"detail"},{default:t((()=>[d(g(e.detail),1)])),_:2},1024)])),_:2},1024)])),_:2},1032,["onClick"]),i(I,{class:"address-actions"},{default:t((()=>[i(I,{class:"action-item",onClick:a=>(e=>{e.isDefault||w({title:"设置默认地址",content:"确定要将该地址设为默认地址吗？",success:a=>{a.confirm&&(L.value.forEach((a=>{a.isDefault=a.id===e.id})),j({title:"设置成功",icon:"success"}),F("addressList",L.value))}})})(e)},{default:t((()=>[i(l,{class:h(["action-icon iconfont",e.isDefault?"icon-check":"icon-circle"])},null,8,["class"]),i(l,{class:"action-text"},{default:t((()=>[d("默认地址")])),_:1})])),_:2},1032,["onClick"]),i(I,{class:"action-item",onClick:a=>(e=>{T.value=!0,K.value=e,N.value={name:e.name,phone:e.phone,region:e.region,regionArray:e.regionArray,detail:e.detail,isDefault:e.isDefault},P.value.open()})(e)},{default:t((()=>[i(l,{class:"action-icon iconfont icon-edit"}),i(l,{class:"action-text"},{default:t((()=>[d("编辑")])),_:1})])),_:2},1032,["onClick"]),i(I,{class:"action-item",onClick:a=>(e=>{w({title:"删除地址",content:"确定要删除该地址吗？",success:a=>{if(a.confirm){const a=L.value.findIndex((a=>a.id===e.id));a>-1&&(L.value.splice(a,1),e.isDefault&&L.value.length>0&&(L.value[0].isDefault=!0),j({title:"删除成功",icon:"success"}),F("addressList",L.value))}}})})(e)},{default:t((()=>[i(l,{class:"action-icon iconfont icon-delete"}),i(l,{class:"action-text"},{default:t((()=>[d("删除")])),_:1})])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1024)))),128))])),_:1}),S.value&&L.value.length>0?(u(),s(I,{key:1,class:"loading-more"},{default:t((()=>[i(l,null,{default:t((()=>[d("加载中...")])),_:1})])),_:1})):f("",!0)])),_:1}),i(I,{class:"add-address",onClick:a[0]||(a[0]=e=>(T.value=!1,K.value=null,N.value={name:"",phone:"",region:"",regionArray:[],detail:"",isDefault:!1},void P.value.open()))},{default:t((()=>[i(l,{class:"add-icon iconfont icon-add"}),i(l,null,{default:t((()=>[d("新增收货地址")])),_:1})])),_:1}),i(W,{ref_key:"addressPopup",ref:P,type:"bottom"},{default:t((()=>[i(I,{class:"address-popup"},{default:t((()=>[i(I,{class:"popup-header"},{default:t((()=>[i(l,{class:"popup-title"},{default:t((()=>[d(g(T.value?"编辑地址":"新增地址"),1)])),_:1}),i(l,{class:"popup-close iconfont icon-close",onClick:B})])),_:1}),i(I,{class:"popup-content"},{default:t((()=>[i(I,{class:"form-item"},{default:t((()=>[i(l,{class:"form-label"},{default:t((()=>[d("收货人")])),_:1}),i($,{class:"form-input",modelValue:N.value.name,"onUpdate:modelValue":a[1]||(a[1]=e=>N.value.name=e),placeholder:"请输入收货人姓名",maxlength:"20"},null,8,["modelValue"])])),_:1}),i(I,{class:"form-item"},{default:t((()=>[i(l,{class:"form-label"},{default:t((()=>[d("手机号码")])),_:1}),i($,{class:"form-input",modelValue:N.value.phone,"onUpdate:modelValue":a[2]||(a[2]=e=>N.value.phone=e),placeholder:"请输入手机号码",type:"number",maxlength:"11"},null,8,["modelValue"])])),_:1}),i(I,{class:"form-item"},{default:t((()=>[i(l,{class:"form-label"},{default:t((()=>[d("所在地区")])),_:1}),i(q,{mode:"region",value:N.value.regionArray,onChange:G,class:"region-picker"},{default:t((()=>[i(I,{class:"picker-value"},{default:t((()=>[d(g(N.value.region||"请选择所在地区"),1)])),_:1})])),_:1},8,["value"])])),_:1}),i(I,{class:"form-item"},{default:t((()=>[i(l,{class:"form-label"},{default:t((()=>[d("详细地址")])),_:1}),i(O,{class:"form-textarea",modelValue:N.value.detail,"onUpdate:modelValue":a[3]||(a[3]=e=>N.value.detail=e),placeholder:"请输入详细地址，如街道、楼牌号等",maxlength:"100"},null,8,["modelValue"])])),_:1}),i(I,{class:"form-item switch-item"},{default:t((()=>[i(l,{class:"form-label"},{default:t((()=>[d("设为默认地址")])),_:1}),i(Q,{checked:N.value.isDefault,onChange:H,color:"#6F87FF"},null,8,["checked"])])),_:1})])),_:1}),i(I,{class:"popup-footer"},{default:t((()=>[i(R,{class:"save-btn",onClick:J},{default:t((()=>[d("保存")])),_:1})])),_:1})])),_:1})])),_:1},512)])),_:1})}}},[["__scopeId","data-v-2f32851f"]]);export{L as default};
