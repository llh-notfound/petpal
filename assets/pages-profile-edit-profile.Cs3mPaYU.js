import{r as e,H as a,c as l,w as s,i as t,a as n,b as u,d as c,e as i,j as o,I as d,y as r,v,x as f,t as m,A as p,J as _,L as h,k as g,u as k,M as b}from"./index-BC-mzwrj.js";import{_ as y}from"./_plugin-vue_export-helper.BCo6x5W8.js";const U=y({__name:"edit-profile",setup(y){const U=e({avatar:"",nickname:"",gender:"",phone:""}),V=e(""),x=e(""),O=e(0),C=e(!1),I=a((()=>O.value>0?`${O.value}秒后重试`:"获取验证码")),P=a((()=>11===V.value.length&&0===O.value)),R=()=>{_({count:1,sizeType:["compressed"],sourceType:["album","camera"],success:e=>{const a=e.tempFilePaths[0];L(a)}})},L=e=>{b({url:"YOUR_UPLOAD_URL",filePath:e,name:"avatar",success:e=>{const a=JSON.parse(e.data);U.value.avatar=a.url}})},T=e=>{U.value.gender=e},A=()=>{P.value&&h({url:"YOUR_API_URL/send-code",method:"POST",data:{phone:V.value},success:()=>{C.value=!0,S()}})},S=()=>{O.value=60;const e=setInterval((()=>{O.value--,O.value<=0&&clearInterval(e)}),1e3)},j=()=>{U.value.nickname?U.value.gender?!V.value||x.value?h({url:"YOUR_API_URL/update-profile",method:"POST",data:{...U.value,phone:V.value,verifyCode:x.value},success:e=>{e.data.success&&(g({title:"保存成功",icon:"success"}),k("userInfo",JSON.stringify(U.value)),setTimeout((()=>{J()}),1500))}}):g({title:"请输入验证码",icon:"none"}):g({title:"请选择性别",icon:"none"}):g({title:"请输入昵称",icon:"none"})},J=()=>{p()};return(e,a)=>{const p=c,_=t,h=o,g=d,k=f;return n(),l(_,{class:"edit-profile-container"},{default:s((()=>[u(_,{class:"nav-bar"},{default:s((()=>[u(p,{class:"nav-title"},{default:s((()=>[i("编辑个人资料")])),_:1}),u(p,{class:"nav-back iconfont icon-back",onClick:J})])),_:1}),u(_,{class:"edit-section"},{default:s((()=>[u(_,{class:"section-title"},{default:s((()=>[i("头像")])),_:1}),u(_,{class:"avatar-edit",onClick:R},{default:s((()=>[u(h,{class:"avatar",src:U.value.avatar||"/static/images/default-avatar.png"},null,8,["src"]),u(p,{class:"edit-hint"},{default:s((()=>[i("点击更换头像")])),_:1})])),_:1})])),_:1}),u(_,{class:"edit-section"},{default:s((()=>[u(_,{class:"section-title"},{default:s((()=>[i("昵称")])),_:1}),u(g,{class:"input-field",type:"text",modelValue:U.value.nickname,"onUpdate:modelValue":a[0]||(a[0]=e=>U.value.nickname=e),placeholder:"请输入昵称",maxlength:"20"},null,8,["modelValue"])])),_:1}),u(_,{class:"edit-section"},{default:s((()=>[u(_,{class:"section-title"},{default:s((()=>[i("性别")])),_:1}),u(_,{class:"gender-select"},{default:s((()=>[u(_,{class:r(["gender-option",{active:"male"===U.value.gender}]),onClick:a[1]||(a[1]=e=>T("male"))},{default:s((()=>[u(p,{class:"iconfont icon-male"}),u(p,null,{default:s((()=>[i("男")])),_:1})])),_:1},8,["class"]),u(_,{class:r(["gender-option",{active:"female"===U.value.gender}]),onClick:a[2]||(a[2]=e=>T("female"))},{default:s((()=>[u(p,{class:"iconfont icon-female"}),u(p,null,{default:s((()=>[i("女")])),_:1})])),_:1},8,["class"])])),_:1})])),_:1}),u(_,{class:"edit-section"},{default:s((()=>[u(_,{class:"section-title"},{default:s((()=>[i("手机号")])),_:1}),u(_,{class:"phone-bind"},{default:s((()=>[u(g,{class:"input-field",type:"number",modelValue:V.value,"onUpdate:modelValue":a[3]||(a[3]=e=>V.value=e),placeholder:"请输入手机号",maxlength:"11"},null,8,["modelValue"]),u(k,{class:"verify-btn",disabled:!P.value,onClick:A},{default:s((()=>[i(m(I.value),1)])),_:1},8,["disabled"])])),_:1}),C.value?(n(),l(_,{key:0,class:"verify-code-input"},{default:s((()=>[u(g,{class:"input-field",type:"number",modelValue:x.value,"onUpdate:modelValue":a[4]||(a[4]=e=>x.value=e),placeholder:"请输入验证码",maxlength:"6"},null,8,["modelValue"])])),_:1})):v("",!0)])),_:1}),u(k,{class:"save-btn",onClick:j},{default:s((()=>[i("保存")])),_:1})])),_:1})}}},[["__scopeId","data-v-5b7149ce"]]);export{U as default};
