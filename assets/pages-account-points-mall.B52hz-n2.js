import{r as s,o as a,p as t,c as e,w as l,i as c,a as o,b as i,d as n,e as u,t as p,S as d,v as r,j as m,f,F as _,g as v,y as g,A as k,K as y,s as b,h as j,k as h,u as P}from"./index-BC-mzwrj.js";import{_ as x}from"./_plugin-vue_export-helper.BCo6x5W8.js";const w=x({__name:"points-mall",setup(x){const w=s(1280),C=s([]),F=s(!1),S=s(!1),T=s(1);s(10);const $=[{id:"P001",name:"宠物玩具套装",description:"包含球、绳、飞盘等多种玩具",points:500,stock:10,image:"/static/images/products/toy-set.jpg"},{id:"P002",name:"高级猫砂",description:"除臭效果好，结团快",points:300,stock:20,image:"/static/images/products/cat-litter.jpg"},{id:"P003",name:"宠物美容券",description:"专业宠物美容服务一次",points:800,stock:5,image:"/static/images/products/grooming.jpg"},{id:"P004",name:"宠物零食礼包",description:"多种口味零食组合",points:400,stock:0,image:"/static/images/products/snacks.jpg"}],q=()=>{S.value=!0,setTimeout((()=>{C.value=$,F.value=!1,S.value=!1,T.value++}),500)},A=()=>{!S.value&&F.value&&q()},I=()=>{k()};return a((()=>{const s=t("userPoints");s&&(w.value=s),q()})),(s,a)=>{const t=n,k=c,x=m,S=d;return o(),e(k,{class:"points-mall-container"},{default:l((()=>[i(k,{class:"nav-bar"},{default:l((()=>[i(t,{class:"nav-title"},{default:l((()=>[u("积分商城")])),_:1}),i(t,{class:"nav-back iconfont icon-back",onClick:I})])),_:1}),i(k,{class:"points-info"},{default:l((()=>[i(k,{class:"points-header"},{default:l((()=>[i(t,{class:"points-label"},{default:l((()=>[u("我的积分")])),_:1}),i(t,{class:"points-value"},{default:l((()=>[u(p(w.value),1)])),_:1})])),_:1}),i(t,{class:"points-desc"},{default:l((()=>[u("积分可用于兑换精美商品，每消费1元可获得1积分")])),_:1})])),_:1}),i(S,{"scroll-y":"",class:"products-scroll-view",onScrolltolower:A},{default:l((()=>[0===C.value.length?(o(),e(k,{key:0,class:"empty-tip"},{default:l((()=>[i(x,{class:"empty-icon",src:"/petpal/static/images/empty-products.png"}),i(t,null,{default:l((()=>[u("暂无可兑换商品")])),_:1})])),_:1})):r("",!0),i(k,{class:"products-list"},{default:l((()=>[(o(!0),f(_,null,v(C.value,((s,a)=>(o(),e(k,{key:a,class:"product-item"},{default:l((()=>[i(x,{class:"product-image",src:s.image,mode:"aspectFill"},null,8,["src"]),i(k,{class:"product-info"},{default:l((()=>[i(k,{class:"product-name"},{default:l((()=>[u(p(s.name),1)])),_:2},1024),i(k,{class:"product-desc"},{default:l((()=>[u(p(s.description),1)])),_:2},1024),i(k,{class:"product-footer"},{default:l((()=>[i(k,{class:"points-required"},{default:l((()=>[i(t,{class:"points-icon"},{default:l((()=>[u("积分")])),_:1}),i(t,{class:"points-number"},{default:l((()=>[u(p(s.points),1)])),_:2},1024)])),_:2},1024),i(t,{class:g(["exchange-btn",{disabled:w.value<s.points||0===s.stock}]),onClick:a=>(s=>{w.value<s.points||0===s.stock||y({title:"兑换确认",content:`确定要使用${s.points}积分兑换${s.name}吗？`,success:a=>{a.confirm&&(b({title:"兑换中..."}),setTimeout((()=>{w.value-=s.points,s.stock--,j(),h({title:"兑换成功",icon:"success"}),P("userPoints",w.value)}),1500))}})})(s)},{default:l((()=>[u(p(w.value<s.points?"积分不足":0===s.stock?"已抢光":"立即兑换"),1)])),_:2},1032,["class","onClick"])])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128))])),_:1}),F.value&&C.value.length>0?(o(),e(k,{key:1,class:"loading-more"},{default:l((()=>[i(t,null,{default:l((()=>[u("加载中...")])),_:1})])),_:1})):r("",!0)])),_:1})])),_:1})}}},[["__scopeId","data-v-92050038"]]);export{w as default};
