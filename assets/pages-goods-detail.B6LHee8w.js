import{r as e,H as a,o as s,E as l,k as t,A as n,c,w as i,i as o,a as u,b as r,d,e as f,X as v,f as _,F as m,g as p,Y as g,j as b,t as y,W as w,y as k,n as h}from"./index-BC-mzwrj.js";import"./index.U0t-2fq9.js";import{m as x}from"./mockGoods.Bj7nj5o7.js";import{_ as C}from"./_plugin-vue_export-helper.BCo6x5W8.js";const j=C({__name:"detail",setup(C){const j=e(1),q=e(null),I=e(!1),F=e("");e(!1);const D=a((()=>(q.value.price*j.value).toFixed(2))),G=()=>{j.value++},N=()=>{j.value>1&&j.value--},A=()=>{q.value.id?q.value.specs&&q.value.specs.length>0&&!F.value?t({title:"请选择规格",icon:"none"}):t({title:"已加入购物车",icon:"success"}):t({title:"商品信息不完整",icon:"none"})},B=()=>{if(!q.value.id)return void t({title:"商品信息不完整",icon:"none"});if(q.value.specs&&q.value.specs.length>0&&!F.value)return void t({title:"请选择规格",icon:"none"});const e=encodeURIComponent(JSON.stringify({goodsId:q.value.id,name:q.value.name,image:q.value.images[0],price:q.value.price,specs:F.value,quantity:j.value}));h({url:`/pages/order/confirm-order?goodsData=${e}`})},E=()=>{n()};return s((()=>{const e=l(),a=e[e.length-1].options.id;a?(async e=>{I.value=!0;try{const a=await x.getGoodsDetail(Number(e));q.value=a}catch(a){console.error("获取商品详情失败:",a),t({title:"获取商品详情失败",icon:"none"})}finally{I.value=!1}})(a):(t({title:"商品ID不存在",icon:"none"}),setTimeout((()=>{n()}),1500))})),(e,a)=>{const s=d,l=o,t=b,n=g,h=v,x=w;return u(),c(l,{class:"detail-container"},{default:i((()=>[r(l,{class:"nav-bar"},{default:i((()=>[r(l,{class:"back-btn",onClick:E},{default:i((()=>[r(s,{class:"iconfont icon-back"})])),_:1}),r(s,{class:"page-title"},{default:i((()=>[f("商品详情")])),_:1})])),_:1}),r(h,{class:"banner-swiper","indicator-dots":"",circular:"",autoplay:!0,interval:"5000",duration:"300"},{default:i((()=>[(u(!0),_(m,null,p(q.value.images,((e,a)=>(u(),c(n,{key:a},{default:i((()=>[r(t,{src:e,mode:"aspectFill",class:"banner-image"},null,8,["src"])])),_:2},1024)))),128))])),_:1}),r(l,{class:"goods-info-section"},{default:i((()=>[r(l,{class:"goods-price"},{default:i((()=>[f("¥"+y(D.value),1)])),_:1}),r(l,{class:"goods-name"},{default:i((()=>[f(y(q.value.name),1)])),_:1}),r(l,{class:"goods-brief"},{default:i((()=>[f(y(q.value.brief),1)])),_:1})])),_:1}),r(l,{class:"specs-section"},{default:i((()=>[r(l,{class:"section-title"},{default:i((()=>[f("规格选择")])),_:1}),r(l,{class:"specs-row"},{default:i((()=>[r(s,{class:"specs-label"},{default:i((()=>[f("数量：")])),_:1}),r(l,{class:"quantity-control"},{default:i((()=>[r(s,{class:"quantity-btn",onClick:N},{default:i((()=>[f("-")])),_:1}),r(s,{class:"quantity-value"},{default:i((()=>[f(y(j.value),1)])),_:1}),r(s,{class:"quantity-btn",onClick:G},{default:i((()=>[f("+")])),_:1})])),_:1})])),_:1})])),_:1}),r(l,{class:"details-section"},{default:i((()=>[r(l,{class:"section-title"},{default:i((()=>[f("商品详情")])),_:1}),r(l,{class:"details-content"},{default:i((()=>[(u(!0),_(m,null,p(q.value.detailImages,((e,a)=>(u(),c(t,{key:a,src:e,mode:"widthFix",class:"detail-image"},null,8,["src"])))),128)),r(x,{nodes:q.value.description},null,8,["nodes"])])),_:1})])),_:1}),r(l,{class:"reviews-section"},{default:i((()=>[r(l,{class:"section-title"},{default:i((()=>[f("用户评价")])),_:1}),r(l,{class:"reviews-list"},{default:i((()=>[(u(!0),_(m,null,p(q.value.reviews,((e,a)=>(u(),c(l,{class:"review-item",key:a},{default:i((()=>[r(l,{class:"review-header"},{default:i((()=>[r(t,{src:e.avatar,class:"reviewer-avatar"},null,8,["src"]),r(l,{class:"reviewer-info"},{default:i((()=>[r(s,{class:"reviewer-name"},{default:i((()=>[f(y(e.nickname),1)])),_:2},1024),r(l,{class:"rating"},{default:i((()=>[(u(),_(m,null,p(5,(a=>r(s,{class:k(["iconfont icon-star",{active:a<=e.rating}]),key:a},null,8,["class"]))),64))])),_:2},1024)])),_:2},1024)])),_:2},1024),r(l,{class:"review-content"},{default:i((()=>[f(y(e.content),1)])),_:2},1024),r(l,{class:"review-time"},{default:i((()=>[f(y(e.time),1)])),_:2},1024)])),_:2},1024)))),128))])),_:1})])),_:1}),r(l,{class:"bottom-bar"},{default:i((()=>[r(l,{class:"cart-btn",onClick:A},{default:i((()=>[f("加入购物车")])),_:1}),r(l,{class:"buy-btn",onClick:B},{default:i((()=>[f("立即购买")])),_:1})])),_:1})])),_:1})}}},[["__scopeId","data-v-bee2d27e"]]);export{j as default};
