import{r as a,o as s,$ as e,l as t,m as l,p as n,c as i,w as c,q as o,u,i as f,a as d,b as r,j as _,e as m,v as p,t as k,d as g,f as v,F as b,g as C,x as y,y as h,n as x,k as L,z as O}from"./index-BC-mzwrj.js";import"./index.U0t-2fq9.js";import{_ as I}from"./_plugin-vue_export-helper.BCo6x5W8.js";const j=I({__name:"profile",setup(I){const j=a(!1),w=a({nickname:"",avatar:"",memberLevel:"黄金会员",petAvatar:"/static/images/pet.png"}),A=a([{name:"订单管理",icon:"icon-order"},{name:"社区互动",icon:"icon-community"},{name:"账户工具",icon:"icon-tools"},{name:"服务支持",icon:"icon-support"}]),M=a([]),U=a({unpaidOrders:0,pendingConsultations:0,processingClaims:0}),q=()=>{{const a=n("petList")||[];return void(M.value=a)}},P=()=>{try{const a=n("pendingItems");if(a)U.value=a;else if(o.isMockUserLoggedIn()){const a=n("orderList")||[],s=a.filter((a=>"待付款"===a.status)).length,e=a.filter((a=>"medical"===a.type&&"待回复"===a.status)).length,t=a.filter((a=>"insurance"===a.type&&"处理中"===a.status)).length;U.value={unpaidOrders:s,pendingConsultations:e||1,processingClaims:t||1},u("pendingItems",U.value)}else U.value={unpaidOrders:0,pendingConsultations:0,processingClaims:0}}catch(a){console.error("获取待处理事项失败",a),U.value={unpaidOrders:0,pendingConsultations:0,processingClaims:0}}};s((()=>{z(),q(),P(),e("updatePetList",(()=>{q()})),e("userLogin",(()=>{z(),q(),P()})),e("userLogout",(()=>{z(),q(),P()}))})),t((()=>{l("updatePetList"),l("userLogin"),l("userLogout")}));const z=()=>{try{const a=n("userInfo");a?(w.value=JSON.parse(a),w.value.petAvatar||(w.value.petAvatar="/static/images/pet.png"),j.value=!0):j.value=!1}catch(a){console.error("获取登录状态失败",a),j.value=!1}},F=()=>{o.createMockUser()},J=()=>{o.logoutMockUser()},N=()=>{j.value?T():S()},S=()=>{x({url:"/pages/login/login"})},T=()=>{x({url:"/pages/profile/edit-profile"})},$=()=>{x({url:"/pages/profile/pending-items"})},B=()=>{x({url:"/pages/profile/pet-management"})},D=a=>{"home"===a&&O({url:"/pages/index/index"})};return(a,s)=>{const e=_,t=g,l=f,n=y;return d(),i(l,{class:"profile-container"},{default:c((()=>[r(l,{class:"user-header"},{default:c((()=>[r(l,{class:"user-info",onClick:N},{default:c((()=>[r(e,{class:"avatar",src:w.value.avatar||"/static/images/default-avatar.png"},null,8,["src"]),r(l,{class:"user-detail"},{default:c((()=>[r(l,{class:"username"},{default:c((()=>[m(k(w.value.nickname||"未登录")+" ",1),j.value?(d(),i(t,{key:0,class:"edit-icon iconfont icon-edit"})):p("",!0)])),_:1}),j.value?(d(),i(l,{key:0,class:"member-tag"},{default:c((()=>[m(k(w.value.memberLevel),1)])),_:1})):(d(),i(l,{key:1,class:"login-btn"},{default:c((()=>[m("点击登录/注册")])),_:1}))])),_:1})])),_:1}),r(l,{class:"pet-avatars",onClick:B},{default:c((()=>[(d(!0),v(b,null,C(M.value,((a,s)=>(d(),i(e,{key:s,class:"pet-avatar",src:a.avatar||"/static/images/pet.png"},null,8,["src"])))),128)),0===M.value.length?(d(),i(l,{key:0,class:"add-pet-hint"},{default:c((()=>[r(t,{class:"iconfont icon-add"}),r(t,null,{default:c((()=>[m("添加宠物")])),_:1})])),_:1})):p("",!0)])),_:1}),r(l,{class:"mock-login-buttons"},{default:c((()=>[j.value?(d(),i(n,{key:1,class:"mock-btn mock-logout",onClick:J},{default:c((()=>[m("退出登录")])),_:1})):(d(),i(n,{key:0,class:"mock-btn mock-login",onClick:F},{default:c((()=>[m("快速模拟登录")])),_:1}))])),_:1})])),_:1}),r(l,{class:"feature-grid"},{default:c((()=>[(d(!0),v(b,null,C(A.value,((a,s)=>(d(),i(l,{key:s,class:"feature-item",onClick:s=>(a=>{if(console.log("点击了功能：",a.name),!j.value&&["订单管理","我的钱包","会员特权","社区互动"].includes(a.name))return L({title:"请先登录",icon:"none"}),void setTimeout((()=>{S()}),1500);switch(a.name){case"订单管理":x({url:"/pages/order/index"});break;case"社区互动":x({url:"/pages/community/index"});break;case"账户工具":x({url:"/pages/account/index"});break;case"服务支持":x({url:"/pages/support/index"})}})(a)},{default:c((()=>[r(l,{class:"feature-icon"},{default:c((()=>[r(t,{class:h(["iconfont",a.icon])},null,8,["class"])])),_:2},1024),r(t,{class:"feature-name"},{default:c((()=>[m(k(a.name),1)])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1}),r(l,{class:"task-section"},{default:c((()=>[r(l,{class:"section-header"},{default:c((()=>[r(t,{class:"section-icon iconfont icon-calendar"}),r(t,{class:"section-title"},{default:c((()=>[m("待处理事项")])),_:1})])),_:1}),j.value?(d(),i(l,{key:0},{default:c((()=>[r(l,{class:"task-item",onClick:$},{default:c((()=>[r(l,{class:"task-left"},{default:c((()=>[r(t,{class:"task-icon iconfont icon-payment"}),r(l,{class:"task-info"},{default:c((()=>[r(l,{class:"task-title"},{default:c((()=>[m("待付款订单")])),_:1}),r(l,{class:"task-desc"},{default:c((()=>[m("有"+k(U.value.unpaidOrders)+"个订单等待支付",1)])),_:1})])),_:1})])),_:1}),r(t,{class:"task-action"},{default:c((()=>[m("去支付")])),_:1})])),_:1}),r(l,{class:"task-item",onClick:$},{default:c((()=>[r(l,{class:"task-left"},{default:c((()=>[r(t,{class:"task-icon iconfont icon-consultation"}),r(l,{class:"task-info"},{default:c((()=>[r(l,{class:"task-title"},{default:c((()=>[m("问诊待回复")])),_:1}),r(l,{class:"task-desc"},{default:c((()=>[m("有"+k(U.value.pendingConsultations)+"个问诊等待回复",1)])),_:1})])),_:1})])),_:1}),r(t,{class:"task-action"},{default:c((()=>[m("查看")])),_:1})])),_:1}),r(l,{class:"task-item",onClick:$},{default:c((()=>[r(l,{class:"task-left"},{default:c((()=>[r(t,{class:"task-icon iconfont icon-insurance"}),r(l,{class:"task-info"},{default:c((()=>[r(l,{class:"task-title"},{default:c((()=>[m("保险理赔进度")])),_:1}),r(l,{class:"task-desc"},{default:c((()=>[m("有"+k(U.value.processingClaims)+"个理赔正在处理中",1)])),_:1})])),_:1})])),_:1}),r(t,{class:"task-action"},{default:c((()=>[m("查看")])),_:1})])),_:1})])),_:1})):(d(),i(l,{key:1,class:"login-required"},{default:c((()=>[r(t,{class:"login-tip"},{default:c((()=>[m("登录后查看您的待处理事项")])),_:1}),r(n,{class:"login-now-btn",onClick:S},{default:c((()=>[m("立即登录")])),_:1})])),_:1}))])),_:1}),r(l,{class:"notification-section"},{default:c((()=>[r(l,{class:"section-header"},{default:c((()=>[r(t,{class:"section-icon iconfont icon-notification"}),r(t,{class:"section-title"},{default:c((()=>[m("活动通知")])),_:1})])),_:1}),r(l,{class:"notification-item"},{default:c((()=>[r(l,{class:"notification-left"},{default:c((()=>[r(t,{class:"notification-icon iconfont icon-gift"}),r(l,{class:"notification-info"},{default:c((()=>[r(l,{class:"notification-title"},{default:c((()=>[m("会员日专属优惠")])),_:1}),r(l,{class:"notification-desc"},{default:c((()=>[m("每月18日，尊享9折特权")])),_:1})])),_:1})])),_:1}),r(t,{class:"notification-time"},{default:c((()=>[m("3分钟前")])),_:1})])),_:1}),r(l,{class:"notification-item"},{default:c((()=>[r(l,{class:"notification-left"},{default:c((()=>[r(t,{class:"notification-icon iconfont icon-coupon"}),r(l,{class:"notification-info"},{default:c((()=>[r(l,{class:"notification-title"},{default:c((()=>[m("新人专享礼包")])),_:1}),r(l,{class:"notification-desc"},{default:c((()=>[m("新用户专享多重优惠")])),_:1})])),_:1})])),_:1}),r(t,{class:"notification-time"},{default:c((()=>[m("昨天")])),_:1})])),_:1})])),_:1}),r(l,{class:"bottom-tabbar"},{default:c((()=>[r(l,{class:"tab-item",onClick:s[0]||(s[0]=a=>D("home"))},{default:c((()=>[r(t,{class:"tab-icon iconfont icon-home"}),r(t,{class:"tab-name"},{default:c((()=>[m("首页")])),_:1})])),_:1}),r(l,{class:"tab-item",onClick:s[1]||(s[1]=a=>D("discover"))},{default:c((()=>[r(t,{class:"tab-icon iconfont icon-compass"}),r(t,{class:"tab-name"},{default:c((()=>[m("发现")])),_:1})])),_:1}),r(l,{class:"tab-item tab-active",onClick:s[2]||(s[2]=a=>D("profile"))},{default:c((()=>[r(t,{class:"tab-icon iconfont icon-user"}),r(t,{class:"tab-name"},{default:c((()=>[m("我的")])),_:1})])),_:1}),r(l,{class:"tab-item",onClick:s[3]||(s[3]=a=>D("settings"))},{default:c((()=>[r(t,{class:"tab-icon iconfont icon-settings"}),r(t,{class:"tab-name"},{default:c((()=>[m("设置")])),_:1})])),_:1})])),_:1})])),_:1})}}},[["__scopeId","data-v-70746579"]]);export{j as default};
