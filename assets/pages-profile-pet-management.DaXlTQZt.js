import{r as e,o as a,c as l,w as t,p as s,i as u,N as n,a as c,b as o,d as i,e as d,f,F as r,g as p,j as m,t as v,O as _,I as b,P as h,x as k,A as g,u as C,K as x,Q as y,D as V,k as P,J as S}from"./index-BC-mzwrj.js";import"./index.U0t-2fq9.js";import{_ as L}from"./_plugin-vue_export-helper.BCo6x5W8.js";const j="/static/images/pet.png",I=L({__name:"pet-management",setup(L){const I=e([]),U=e({avatar:"",name:"",breed:"",age:"",healthStatus:""}),w=e(!1),D=e(null),F=["很好","良好","一般","需要治疗","正在恢复中"],T=()=>{w.value=!1,U.value={avatar:"",name:"",breed:"",age:"",healthStatus:""},D.value.open()},z=()=>{S({count:1,sizeType:["compressed"],sourceType:["album","camera"],success:e=>{const a=e.tempFilePaths[0];A(a)}})},A=e=>{U.value.avatar=e},J=e=>{U.value.healthStatus=F[e.detail.value]},K=()=>{if(U.value.name)if(U.value.breed)if(U.value.age){if(U.value.healthStatus){if(w.value){const e=I.value.findIndex((e=>e.id===U.value.id));e>-1&&(I.value[e]={...U.value})}else U.value.id=Date.now().toString(),I.value.push({...U.value});return C("petList",I.value),V("updatePetList"),P({title:"保存成功",icon:"success"}),void N()}P({title:"请选择健康状况",icon:"none"})}else P({title:"请输入宠物年龄",icon:"none"});else P({title:"请输入宠物品种",icon:"none"});else P({title:"请输入宠物名称",icon:"none"})},N=()=>{D.value.close()},O=()=>{g()};return a((()=>{(()=>{try{const e=s("petList")||[];I.value=e}catch(e){console.error("获取宠物列表失败",e),I.value=[]}})()})),(e,a)=>{const S=i,L=u,A=m,Q=b,$=h,q=k,B=n("uni-popup");return c(),l(L,{class:"pet-management-container"},{default:t((()=>[o(L,{class:"nav-bar"},{default:t((()=>[o(S,{class:"nav-title"},{default:t((()=>[d("宠物管理")])),_:1}),o(S,{class:"nav-back iconfont icon-back",onClick:O})])),_:1}),o(L,{class:"pet-list"},{default:t((()=>[(c(!0),f(r,null,p(I.value,((e,a)=>(c(),l(L,{key:a,class:"pet-item",onClick:a=>(e=>{C("currentPet",e),g()})(e)},{default:t((()=>[o(A,{class:"pet-avatar",src:e.avatar||j},null,8,["src"]),o(L,{class:"pet-info"},{default:t((()=>[o(L,{class:"pet-name"},{default:t((()=>[d(v(e.name),1)])),_:2},1024),o(L,{class:"pet-details"},{default:t((()=>[o(S,null,{default:t((()=>[d(v(e.breed),1)])),_:2},1024),o(S,null,{default:t((()=>[d(v(e.age)+"岁",1)])),_:2},1024),o(S,null,{default:t((()=>[d(v(e.healthStatus),1)])),_:2},1024)])),_:2},1024)])),_:2},1024),o(L,{class:"pet-actions"},{default:t((()=>[o(S,{class:"edit-btn iconfont icon-edit",onClick:_((a=>(e=>{w.value=!0,U.value={...e},D.value.open()})(e)),["stop"])},null,8,["onClick"]),o(S,{class:"delete-btn",onClick:_((a=>(e=>{x({title:"确认删除",content:`确定要删除宠物"${e.name}"吗？`,success:a=>{if(a.confirm){const a=I.value.findIndex((a=>a.id===e.id));if(a>-1){const l=s("currentPet");l&&l.id===e.id&&y("currentPet"),I.value.splice(a,1),C("petList",I.value),V("updatePetList"),P({title:"删除成功",icon:"success"})}}}})})(e)),["stop"])},{default:t((()=>[d("删除")])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1}),o(L,{class:"add-pet-btn",onClick:T},{default:t((()=>[o(S,{class:"iconfont icon-add"}),o(S,null,{default:t((()=>[d("添加新宠物")])),_:1})])),_:1}),o(B,{ref_key:"popup",ref:D,type:"bottom"},{default:t((()=>[o(L,{class:"pet-edit-form"},{default:t((()=>[o(L,{class:"form-header"},{default:t((()=>[o(S,{class:"form-title"},{default:t((()=>[d(v(w.value?"编辑宠物":"添加宠物"),1)])),_:1}),o(S,{class:"close-btn iconfont icon-close",onClick:N})])),_:1}),o(L,{class:"form-content"},{default:t((()=>[o(L,{class:"form-item"},{default:t((()=>[o(S,{class:"item-label"},{default:t((()=>[d("头像")])),_:1}),o(L,{class:"avatar-upload",onClick:z},{default:t((()=>[o(A,{class:"pet-avatar",src:U.value.avatar||j},null,8,["src"]),o(S,{class:"upload-hint"},{default:t((()=>[d("点击更换头像")])),_:1})])),_:1})])),_:1}),o(L,{class:"form-item"},{default:t((()=>[o(S,{class:"item-label"},{default:t((()=>[d("名称")])),_:1}),o(Q,{class:"input-field",type:"text",modelValue:U.value.name,"onUpdate:modelValue":a[0]||(a[0]=e=>U.value.name=e),placeholder:"请输入宠物名称",maxlength:"20"},null,8,["modelValue"])])),_:1}),o(L,{class:"form-item"},{default:t((()=>[o(S,{class:"item-label"},{default:t((()=>[d("品种")])),_:1}),o(Q,{class:"input-field",type:"text",modelValue:U.value.breed,"onUpdate:modelValue":a[1]||(a[1]=e=>U.value.breed=e),placeholder:"请输入宠物品种"},null,8,["modelValue"])])),_:1}),o(L,{class:"form-item"},{default:t((()=>[o(S,{class:"item-label"},{default:t((()=>[d("年龄")])),_:1}),o(Q,{class:"input-field",type:"number",modelValue:U.value.age,"onUpdate:modelValue":a[2]||(a[2]=e=>U.value.age=e),placeholder:"请输入宠物年龄"},null,8,["modelValue"])])),_:1}),o(L,{class:"form-item"},{default:t((()=>[o(S,{class:"item-label"},{default:t((()=>[d("健康状况")])),_:1}),o($,{mode:"selector",range:F,onChange:J},{default:t((()=>[o(L,{class:"picker-field"},{default:t((()=>[d(v(U.value.healthStatus||"请选择健康状况"),1)])),_:1})])),_:1})])),_:1})])),_:1}),o(L,{class:"form-footer"},{default:t((()=>[o(q,{class:"cancel-btn",onClick:N},{default:t((()=>[d("取消")])),_:1}),o(q,{class:"save-btn",onClick:K},{default:t((()=>[d("保存")])),_:1})])),_:1})])),_:1})])),_:1},512)])),_:1})}}},[["__scopeId","data-v-074813d2"]]);export{I as default};
